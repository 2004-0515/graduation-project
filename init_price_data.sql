-- =====================================================
-- 价格历史和降价提醒数据初始化脚本
-- 执行方式: mysql -u root -p shopping_mall < init_price_data.sql
-- =====================================================

USE shopping_mall;

-- 清空现有数据
DELETE FROM tb_price_history;
DELETE FROM tb_price_alert;

-- =====================================================
-- 插入价格历史数据
-- 基于实际产品的 price 和 original_price 生成合理的价格变化历史
-- =====================================================
INSERT INTO tb_price_history (product_id, price, original_price, recorded_time, change_type, change_amount, change_rate) VALUES
-- iPhone 15 Pro Max (ID=1): 原价10999 -> 当前9999
(1, 10999.00, 10999.00, '2025-12-01 10:00:00', 'INITIAL', 0.00, 0.00),
(1, 10499.00, 10999.00, '2025-12-11 10:00:00', 'DECREASE', -500.00, -4.55),
(1, 9999.00, 10999.00, '2025-12-25 10:00:00', 'DECREASE', -500.00, -4.76),

-- 华为 Mate 60 Pro (ID=2): 原价7999 -> 当前6999
(2, 7999.00, 7999.00, '2025-12-02 14:30:00', 'INITIAL', 0.00, 0.00),
(2, 7499.00, 7999.00, '2025-12-12 14:30:00', 'DECREASE', -500.00, -6.25),
(2, 6999.00, 7999.00, '2025-12-22 14:30:00', 'DECREASE', -500.00, -6.67),

-- 小米14 Ultra (ID=3): 原价6499 -> 当前5999
(3, 6499.00, 6499.00, '2025-12-05 09:15:00', 'INITIAL', 0.00, 0.00),
(3, 6199.00, 6499.00, '2025-12-15 09:15:00', 'DECREASE', -300.00, -4.62),
(3, 5999.00, 6499.00, '2025-12-25 09:15:00', 'DECREASE', -200.00, -3.23),

-- MacBook Pro 14 (ID=4): 原价16999 -> 当前14999
(4, 16999.00, 16999.00, '2025-12-08 16:00:00', 'INITIAL', 0.00, 0.00),
(4, 15999.00, 16999.00, '2025-12-18 16:00:00', 'DECREASE', -1000.00, -5.88),
(4, 14999.00, 16999.00, '2025-12-28 16:00:00', 'DECREASE', -1000.00, -6.25),

-- iPad Pro 12.9 (ID=5): 原价9499 -> 当前8499
(5, 9499.00, 9499.00, '2025-12-10 11:30:00', 'INITIAL', 0.00, 0.00),
(5, 8999.00, 9499.00, '2025-12-20 11:30:00', 'DECREASE', -500.00, -5.26),
(5, 8499.00, 9499.00, '2025-12-30 11:30:00', 'DECREASE', -500.00, -5.56),

-- 海尔冰箱 BCD-470 (ID=6): 原价5299 -> 当前4599
(6, 5299.00, 5299.00, '2025-12-12 08:00:00', 'INITIAL', 0.00, 0.00),
(6, 4899.00, 5299.00, '2025-12-22 08:00:00', 'DECREASE', -400.00, -7.55),
(6, 4599.00, 5299.00, '2026-01-02 08:00:00', 'DECREASE', -300.00, -6.12),

-- 美的空调 KFR-35GW (ID=7): 原价3499 -> 当前2999
(7, 3499.00, 3499.00, '2025-12-14 13:45:00', 'INITIAL', 0.00, 0.00),
(7, 3199.00, 3499.00, '2025-12-24 13:45:00', 'DECREASE', -300.00, -8.57),
(7, 2999.00, 3499.00, '2026-01-04 13:45:00', 'DECREASE', -200.00, -6.25),

-- 西门子洗衣机 WM12 (ID=8): 原价4599 -> 当前3899
(8, 4599.00, 4599.00, '2025-12-16 10:20:00', 'INITIAL', 0.00, 0.00),
(8, 4199.00, 4599.00, '2025-12-26 10:20:00', 'DECREASE', -400.00, -8.70),
(8, 3899.00, 4599.00, '2026-01-06 10:20:00', 'DECREASE', -300.00, -7.14),

-- 戴森吸尘器 V15 (ID=9): 原价5490 -> 当前4990
(9, 5490.00, 5490.00, '2025-12-18 15:00:00', 'INITIAL', 0.00, 0.00),
(9, 5190.00, 5490.00, '2025-12-28 15:00:00', 'DECREASE', -300.00, -5.46),
(9, 4990.00, 5490.00, '2026-01-08 15:00:00', 'DECREASE', -200.00, -3.85),

-- Nike Air Max 270 (ID=10): 原价1199 -> 当前899
(10, 1199.00, 1199.00, '2025-12-20 09:00:00', 'INITIAL', 0.00, 0.00),
(10, 1049.00, 1199.00, '2025-12-28 09:00:00', 'DECREASE', -150.00, -12.51),
(10, 899.00, 1199.00, '2026-01-05 09:00:00', 'DECREASE', -150.00, -14.30),

-- Adidas Ultraboost (ID=11): 原价1499 -> 当前1099
(11, 1499.00, 1499.00, '2025-12-21 14:30:00', 'INITIAL', 0.00, 0.00),
(11, 1299.00, 1499.00, '2025-12-29 14:30:00', 'DECREASE', -200.00, -13.34),
(11, 1099.00, 1499.00, '2026-01-06 14:30:00', 'DECREASE', -200.00, -15.40),

-- 优衣库羽绒服 (ID=12): 原价699 -> 当前499
(12, 699.00, 699.00, '2025-12-22 11:00:00', 'INITIAL', 0.00, 0.00),
(12, 599.00, 699.00, '2025-12-30 11:00:00', 'DECREASE', -100.00, -14.31),
(12, 499.00, 699.00, '2026-01-07 11:00:00', 'DECREASE', -100.00, -16.69),

-- SK-II神仙水 (ID=13): 原价1790 -> 当前1590
(13, 1790.00, 1790.00, '2025-12-24 10:00:00', 'INITIAL', 0.00, 0.00),
(13, 1690.00, 1790.00, '2026-01-01 10:00:00', 'DECREASE', -100.00, -5.59),
(13, 1590.00, 1790.00, '2026-01-09 10:00:00', 'DECREASE', -100.00, -5.92),

-- 兰蔻小黑瓶 (ID=14): 原价1480 -> 当前1280
(14, 1480.00, 1480.00, '2025-12-25 09:30:00', 'INITIAL', 0.00, 0.00),
(14, 1380.00, 1480.00, '2026-01-02 09:30:00', 'DECREASE', -100.00, -6.76),
(14, 1280.00, 1480.00, '2026-01-10 09:30:00', 'DECREASE', -100.00, -7.25),

-- 雅诗兰黛眼霜 (ID=15): 原价690 -> 当前590
(15, 690.00, 690.00, '2025-12-26 14:00:00', 'INITIAL', 0.00, 0.00),
(15, 640.00, 690.00, '2026-01-03 14:00:00', 'DECREASE', -50.00, -7.25),
(15, 590.00, 690.00, '2026-01-11 14:00:00', 'DECREASE', -50.00, -7.81),

-- 三只松鼠坚果礼盒 (ID=16): 原价168 -> 当前128
(16, 168.00, 168.00, '2025-12-27 08:00:00', 'INITIAL', 0.00, 0.00),
(16, 148.00, 168.00, '2026-01-03 08:00:00', 'DECREASE', -20.00, -11.90),
(16, 128.00, 168.00, '2026-01-10 08:00:00', 'DECREASE', -20.00, -13.51),

-- 农夫山泉矿泉水 (ID=17): 原价49.90 -> 当前39.90
(17, 49.90, 49.90, '2025-12-15 12:00:00', 'INITIAL', 0.00, 0.00),
(17, 44.90, 49.90, '2025-12-25 12:00:00', 'DECREASE', -5.00, -10.02),
(17, 39.90, 49.90, '2026-01-05 12:00:00', 'DECREASE', -5.00, -11.14),

-- 星巴克咖啡豆 (ID=18): 原价238 -> 当前198
(18, 238.00, 238.00, '2025-12-28 10:00:00', 'INITIAL', 0.00, 0.00),
(18, 218.00, 238.00, '2026-01-04 10:00:00', 'DECREASE', -20.00, -8.40),
(18, 198.00, 238.00, '2026-01-11 10:00:00', 'DECREASE', -20.00, -9.17),

-- 三体全集 (ID=19): 原价128 -> 当前99
(19, 128.00, 128.00, '2025-12-28 16:00:00', 'INITIAL', 0.00, 0.00),
(19, 109.00, 128.00, '2026-01-04 16:00:00', 'DECREASE', -19.00, -14.84),
(19, 99.00, 128.00, '2026-01-11 16:00:00', 'DECREASE', -10.00, -9.17),

-- 人类简史 (ID=20): 原价88 -> 当前68
(20, 88.00, 88.00, '2025-12-29 09:00:00', 'INITIAL', 0.00, 0.00),
(20, 78.00, 88.00, '2026-01-05 09:00:00', 'DECREASE', -10.00, -11.36),
(20, 68.00, 88.00, '2026-01-11 09:00:00', 'DECREASE', -10.00, -12.82);

-- =====================================================
-- 插入降价提醒数据
-- 用户: zhangsan(2), lisi(3), wangwu(4), zhaoliu(5), sunqi(6), xiaoming(10)
-- 状态: 0=监控中, 1=已触发, 2=已取消
-- =====================================================
INSERT INTO tb_price_alert (user_id, product_id, target_price, current_price, status, notified, created_time, updated_time) VALUES
-- zhangsan(ID=2)的降价提醒
(2, 1, 9500.00, 9999.00, 0, 0, '2026-01-08 10:30:00', '2026-01-08 10:30:00'),
(2, 4, 14500.00, 14999.00, 0, 0, '2026-01-09 14:20:00', '2026-01-09 14:20:00'),

-- lisi(ID=3)的降价提醒
(3, 2, 6500.00, 6999.00, 0, 0, '2026-01-07 09:15:00', '2026-01-07 09:15:00'),
(3, 10, 850.00, 899.00, 0, 0, '2026-01-10 11:00:00', '2026-01-10 11:00:00'),

-- wangwu(ID=4)的降价提醒
(4, 3, 5500.00, 5999.00, 0, 0, '2026-01-08 15:00:00', '2026-01-08 15:00:00'),

-- zhaoliu(ID=5)的降价提醒
(5, 5, 8000.00, 8499.00, 0, 0, '2026-01-09 09:00:00', '2026-01-09 09:00:00'),

-- sunqi(ID=6)的降价提醒
(6, 13, 1500.00, 1590.00, 0, 0, '2026-01-10 14:00:00', '2026-01-10 14:00:00'),

-- xiaoming(ID=10)的降价提醒
(10, 19, 89.00, 99.00, 0, 0, '2026-01-10 16:00:00', '2026-01-10 16:00:00');

SELECT '价格历史数据插入完成' AS status, COUNT(*) AS count FROM tb_price_history;
SELECT '降价提醒数据插入完成' AS status, COUNT(*) AS count FROM tb_price_alert;
