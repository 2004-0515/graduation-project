-- 修复所有空表和中文数据
-- 请在 Navicat 中执行此文件，确保连接编码为 UTF-8
USE shopping_mall;
SET NAMES utf8mb4;

-- =====================================================
-- 1. 清空并重新插入优惠券表 (tb_coupon) - 中文数据
-- =====================================================
DELETE FROM tb_user_coupon;
DELETE FROM tb_coupon;

INSERT INTO tb_coupon (id, name, description, type, discount_amount, discount_rate, min_amount, max_discount, total_count, claimed_count, limit_per_user, start_time, end_time, status, created_time, updated_time) VALUES
(1, '新人专享20元券', '新用户首单立减20元', 1, 20.00, NULL, 100.00, NULL, 10000, 156, 1, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(2, '满300减50券', '满300元立减50元', 1, 50.00, NULL, 300.00, NULL, 5000, 234, 2, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(3, '满500减80券', '满500元立减80元', 1, 80.00, NULL, 500.00, NULL, 3000, 156, 2, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(4, '满1000减150券', '满1000元立减150元', 1, 150.00, NULL, 1000.00, NULL, 2000, 89, 1, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(5, '数码专享9折券', '数码产品9折优惠', 2, NULL, 0.90, 500.00, 200.00, 1500, 67, 1, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(6, '美妆8.5折券', '美妆护肤8.5折', 2, NULL, 0.85, 200.00, 100.00, 2000, 123, 2, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(7, '服装满200减30', '服装鞋帽满减', 1, 30.00, NULL, 200.00, NULL, 3000, 189, 3, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(8, '食品满99减15', '食品饮料满减', 1, 15.00, NULL, 99.00, NULL, 5000, 345, 5, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW()),
(9, '新年特惠100元券', '新年大促满800减100', 1, 100.00, NULL, 800.00, NULL, 1000, 45, 1, '2026-01-01 00:00:00', '2026-01-31 23:59:59', 1, NOW(), NOW()),
(10, '会员专享95折', 'VIP会员专属折扣', 2, NULL, 0.95, 100.00, 500.00, 500, 23, 1, '2025-01-01 00:00:00', '2026-12-31 23:59:59', 1, NOW(), NOW());

-- =====================================================
-- 2. 用户优惠券表 (tb_user_coupon)
-- =====================================================
INSERT INTO tb_user_coupon (user_id, coupon_id, status, order_id, used_time, created_time) VALUES
(2, 1, 0, NULL, NULL, '2025-12-01 10:00:00'),
(2, 2, 0, NULL, NULL, '2025-12-05 14:00:00'),
(3, 1, 0, NULL, NULL, '2025-12-02 09:00:00'),
(3, 5, 0, NULL, NULL, '2025-12-08 11:00:00'),
(4, 1, 0, NULL, NULL, '2025-12-03 16:00:00'),
(4, 7, 0, NULL, NULL, '2025-12-10 10:00:00'),
(5, 1, 0, NULL, NULL, '2025-12-04 08:00:00'),
(5, 8, 0, NULL, NULL, '2025-12-12 15:00:00'),
(6, 1, 0, NULL, NULL, '2025-12-05 11:00:00'),
(6, 6, 0, NULL, NULL, '2025-12-15 09:00:00'),
(7, 2, 0, NULL, NULL, '2025-12-06 14:00:00'),
(8, 3, 0, NULL, NULL, '2025-12-07 10:00:00'),
(9, 4, 0, NULL, NULL, '2025-12-08 16:00:00'),
(10, 1, 0, NULL, NULL, '2025-12-09 09:00:00'),
(10, 8, 0, NULL, NULL, '2025-12-18 11:00:00');

-- =====================================================
-- 3. 上传文件表 (tb_upload_file) - 中文数据
-- =====================================================
DELETE FROM tb_upload_file;

INSERT INTO tb_upload_file (file_type, file_path, original_name, file_size, user_id, username, status, reviewer_id, reviewer_name, review_time, review_remark, related_id, created_time) VALUES
('AVATAR', '/uploads/avatars/user2.jpg', '头像.jpg', 102400, 2, 'zhangsan', 1, 1, 'admin', NOW(), '审核通过', 2, '2025-12-01 10:00:00'),
('AVATAR', '/uploads/avatars/user3.jpg', '照片.jpg', 98765, 3, 'lisi', 1, 1, 'admin', NOW(), '审核通过', 3, '2025-12-02 11:00:00'),
('PRODUCT', '/uploads/products/prod1.jpg', '商品图1.jpg', 204800, 2, 'zhangsan', 1, 1, 'admin', NOW(), '商品图片审核通过', 1, '2025-12-03 14:00:00'),
('REVIEW', '/uploads/reviews/review1.jpg', '评价图片.jpg', 153600, 4, 'wangwu', 0, NULL, NULL, NULL, NULL, 1, '2025-12-10 09:00:00'),
('PRODUCT', '/uploads/products/prod2.jpg', '商品图2.jpg', 178432, 5, 'zhaoliu', 2, 1, 'admin', NOW(), '图片不清晰，请重新上传', 2, '2025-12-05 16:00:00');

-- =====================================================
-- 4. 消费成就表 (tb_consumption_achievement)
-- =====================================================
INSERT INTO tb_consumption_achievement (user_id, achievement_type, achievement_name, achievement_desc, achieved_time) VALUES
(2, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-11-15 10:30:00'),
(2, 'BUDGET_MASTER', '预算达人', '连续3个月控制在预算内', '2025-12-01 00:00:00'),
(3, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-11-20 14:20:00'),
(3, 'SAVING_STAR', '省钱之星', '累计节省超过500元', '2025-12-10 00:00:00'),
(4, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-11-22 09:15:00'),
(5, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-11-25 16:45:00'),
(5, 'RATIONAL_BUYER', '理性消费者', '30天内无冲动消费', '2025-12-20 00:00:00'),
(6, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-11-28 11:00:00'),
(7, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-12-01 13:30:00'),
(8, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-12-05 10:00:00'),
(9, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-12-08 15:20:00'),
(10, 'FIRST_ORDER', '首单达成', '完成第一笔订单', '2025-12-10 09:45:00');

-- =====================================================
-- 5. 消费预算表 (tb_consumption_budget)
-- =====================================================
INSERT INTO tb_consumption_budget (user_id, monthly_budget, budget_month, alert_enabled, alert_threshold, created_time, updated_time) VALUES
(2, 2000.00, '202601', 1, 80, NOW(), NOW()),
(3, 3000.00, '202601', 1, 80, NOW(), NOW()),
(4, 1500.00, '202601', 1, 90, NOW(), NOW()),
(5, 2500.00, '202601', 0, 80, NOW(), NOW()),
(6, 1800.00, '202601', 1, 85, NOW(), NOW()),
(7, 1200.00, '202601', 1, 80, NOW(), NOW()),
(8, 2200.00, '202601', 0, 75, NOW(), NOW()),
(9, 600.00, '202601', 1, 90, NOW(), NOW()),
(10, 1000.00, '202601', 1, 80, NOW(), NOW());

-- =====================================================
-- 6. 心愿单表 (tb_wishlist)
-- =====================================================
INSERT INTO tb_wishlist (user_id, product_id, created_time) VALUES
(2, 1, '2025-12-01 10:00:00'),
(2, 5, '2025-12-02 14:30:00'),
(2, 12, '2025-12-05 09:15:00'),
(3, 3, '2025-12-03 11:00:00'),
(3, 8, '2025-12-06 16:20:00'),
(3, 15, '2025-12-08 10:45:00'),
(4, 2, '2025-12-04 13:00:00'),
(4, 10, '2025-12-07 15:30:00'),
(5, 6, '2025-12-05 08:00:00'),
(5, 11, '2025-12-09 12:00:00'),
(5, 20, '2025-12-10 17:00:00'),
(6, 4, '2025-12-06 09:30:00'),
(6, 9, '2025-12-08 14:00:00'),
(7, 7, '2025-12-07 10:00:00'),
(7, 14, '2025-12-10 11:30:00'),
(8, 13, '2025-12-08 16:00:00'),
(9, 16, '2025-12-09 09:00:00'),
(9, 18, '2025-12-11 13:45:00'),
(10, 17, '2025-12-10 10:30:00'),
(10, 19, '2025-12-12 15:00:00');

SELECT '数据修复完成！' as result;
